<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Machine learning made easy — machine_learn • healthcareai</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Machine learning made easy — machine_learn" />

<meta property="og:description" content="Prepare data and train machine learning models." />

<meta property="og:image" content="https://docs.healthcare.ai/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85609357-1', 'auto');
  ga('send', 'pageview');

</script>



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">healthcareai</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/site_only/healthcareai.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/site_only/db_connections.html">Database Connections</a>
    </li>
    <li>
      <a href="../articles/site_only/deploy_model.html">Deploying a model</a>
    </li>
    <li>
      <a href="../articles/site_only/transitioning.html">Transition from Version 1</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HealthCatalyst/healthcareai-r">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://healthcare-ai.slack.com/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Machine learning made easy</h1>
    
    </div>

    
    <p>Prepare data and train machine learning models.</p>
    

    <pre class="usage"><span class='fu'>machine_learn</span>(<span class='no'>d</span>, <span class='no'>...</span>, <span class='no'>outcome</span>, <span class='no'>models</span>, <span class='kw'>tune</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>positive_class</span>,
  <span class='kw'>n_folds</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>tune_depth</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>impute</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>A data frame</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Columns to be ignored in model training, e.g. ID columns,
unquoted.</p></td>
    </tr>
    <tr>
      <th>outcome</th>
      <td><p>Name of the target column, i.e. what you want to predict.
Unquoted. Must be named, i.e. you must specify <code>outcome = </code></p></td>
    </tr>
    <tr>
      <th>models</th>
      <td><p>Models to be trained, k-nearest neighbors and random forest by
default. See <code><a href='get_supported_models.html'>supported_models</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>tune</th>
      <td><p>If TRUE (default) models will be tuned via
<code><a href='tune_models.html'>tune_models</a></code>. If FALSE, models will be trained via
<code><a href='flash_models.html'>flash_models</a></code> which is substantially faster but produces
less-predictively powerful models.</p></td>
    </tr>
    <tr>
      <th>positive_class</th>
      <td><p>For classification only, which outcome level is the
"yes" case, i.e. should be associated with high probabilities? Defaults to
"Y" or "yes" if present, otherwise is the first level of the outcome
variable (first alphabetically if the training data outcome was not already
a factor).</p></td>
    </tr>
    <tr>
      <th>n_folds</th>
      <td><p>How many folds to use to assess out-of-fold accuracy? Default
= 5. Models are evaluated on out-of-fold predictions whether tune is TRUE
or FALSE.</p></td>
    </tr>
    <tr>
      <th>tune_depth</th>
      <td><p>How many hyperparameter combinations to try? Defualt = 10.
Ignored if tune is FALSE.</p></td>
    </tr>
    <tr>
      <th>impute</th>
      <td><p>Logical, if TRUE (default) missing values will be filled by
<code><a href='hcai_impute.html'>hcai_impute</a></code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A model_list object. You can call <code>plot</code>, <code>summary</code>,
  <code>evaluate</code>, or <code>predict</code> on a model_list.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is a high-level wrapper function. For finer control of data
  cleaning and preparation use <code><a href='prep_data.html'>prep_data</a></code> or the functions it
  wraps. For finer control of model tuning use <code><a href='tune_models.html'>tune_models</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Split the data into training and test sets, using just 100 rows for speed</span>
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='split_train_test.html'>split_train_test</a></span>(<span class='kw'>d</span> <span class='kw'>=</span> <span class='no'>pima_diabetes</span>[<span class='fl'>1</span>:<span class='fl'>100</span>, ],
                      <span class='kw'>outcome</span> <span class='kw'>=</span> <span class='no'>diabetes</span>,
                      <span class='kw'>percent_train</span> <span class='kw'>=</span> <span class='fl'>.9</span>)

<span class='co'>### Classification ###</span>

<span class='co'># Clean and prep the training data, specifying that patient_id is an ID column,</span>
<span class='co'># and tune algorithms over hyperparameter values to predict diabetes</span>
<span class='no'>diabetes_models</span> <span class='kw'>&lt;-</span> <span class='fu'>machine_learn</span>(<span class='no'>d</span>$<span class='no'>train</span>, <span class='no'>patient_id</span>, <span class='kw'>outcome</span> <span class='kw'>=</span> <span class='no'>diabetes</span>)</div><div class='output co'>#&gt; <span class='message'>Training new data prep recipe</span></div><div class='output co'>#&gt; <span class='message'>Variable(s) ignored in prep_data won't be used to tune models: patient_id</span></div><div class='output co'>#&gt; <span class='message'>diabetes looks categorical, so training classification algorithms.</span></div><div class='output co'>#&gt; <span class='message'>Training with cross validation: Random Forest</span></div><div class='output co'>#&gt; <span class='message'>Training with cross validation: k-Nearest Neighbors</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>*** Models successfully trained. The model object contains the training data minus ignored ID columns. ***</span>
#&gt; <span class='message'>*** If there was PHI in training data, normal PHI protocols apply to the model object. ***</span></div><div class='input'>
<span class='co'># Inspect model specification and performance</span>
<span class='no'>diabetes_models</span></div><div class='output co'>#&gt; Algorithms Trained: Random Forest, k-Nearest Neighbors
#&gt; Target: diabetes
#&gt; Class: Classification
#&gt; Performance Metric: AUROC
#&gt; Number of Observations: 91
#&gt; Number of Features: 12
#&gt; Models Trained: 2018-04-20 13:20:13 
#&gt; 
#&gt; Models tuned via 5-fold cross validation over 10 combinations of hyperparameter values.
#&gt; Best model: Random Forest
#&gt; AUPR = 0.56, AUROC = 0.77
#&gt; Optimal hyperparameter values:
#&gt;   mtry = 1
#&gt;   splitrule = extratrees
#&gt;   min.node.size = 19 </div><div class='input'>
<span class='co'># Make predictions (predicted probability of diabetes) on test data</span>
<span class='fu'>predict</span>(<span class='no'>diabetes_models</span>, <span class='no'>d</span>$<span class='no'>test</span>)</div><div class='output co'>#&gt; <span class='message'>Prepping data based on provided recipe</span></div><div class='output co'>#&gt; <span class='message'>"predicted_diabetes" predicted by Random Forest last trained: 2018-04-20 13:20:13</span>
#&gt; <span class='message'>Performance in training: AUROC = 0.77</span></div><div class='output co'>#&gt; # A tibble: 9 x 11
#&gt;   diabetes predicted_diabet… patient_id pregnancies plasma_glucose diastolic_bp
#&gt; * &lt;chr&gt;                &lt;dbl&gt;      &lt;int&gt;       &lt;int&gt;          &lt;int&gt;        &lt;int&gt;
#&gt; 1 Y                    0.359          7           3             78           50
#&gt; 2 Y                    0.398         17           0            118           84
#&gt; 3 N                    0.501         31           5            109           75
#&gt; 4 N                    0.292         36           4            103           60
#&gt; 5 N                    0.284         47           1            146           56
#&gt; 6 N                    0.284         70           4            146           85
#&gt; 7 Y                    0.397         73          13            126           90
#&gt; 8 N                    0.422         78           5             95           72
#&gt; 9 N                    0.279         83           7             83           78
#&gt; # ... with 5 more variables: skinfold &lt;int&gt;, insulin &lt;int&gt;, weight_class &lt;chr&gt;,
#&gt; #   pedigree &lt;dbl&gt;, age &lt;int&gt;</div><div class='input'>
<span class='co'>### Regression ###</span>

<span class='co'># If the outcome variable is numeric, regression models will be trained</span>
<span class='no'>age_model</span> <span class='kw'>&lt;-</span> <span class='fu'>machine_learn</span>(<span class='no'>d</span>$<span class='no'>train</span>, <span class='no'>patient_id</span>, <span class='kw'>outcome</span> <span class='kw'>=</span> <span class='no'>age</span>)</div><div class='output co'>#&gt; <span class='message'>Training new data prep recipe</span></div><div class='output co'>#&gt; <span class='message'>Variable(s) ignored in prep_data won't be used to tune models: patient_id</span></div><div class='output co'>#&gt; <span class='message'>age looks numeric, so training regression algorithms.</span></div><div class='output co'>#&gt; <span class='message'>Training with cross validation: Random Forest</span></div><div class='output co'>#&gt; <span class='message'>Training with cross validation: k-Nearest Neighbors</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>*** Models successfully trained. The model object contains the training data minus ignored ID columns. ***</span>
#&gt; <span class='message'>*** If there was PHI in training data, normal PHI protocols apply to the model object. ***</span></div><div class='input'>
<span class='co'># If new data isn't specifed, get predictions on training data</span>
<span class='fu'>predict</span>(<span class='no'>age_model</span>)</div><div class='output co'>#&gt; <span class='message'>"predicted_age" predicted by Random Forest last trained: 2018-04-20 13:20:17</span>
#&gt; <span class='message'>Performance in training: RMSE = 9.04</span></div><div class='output co'>#&gt; # A tibble: 91 x 16
#&gt;      age predicted_age pregnancies plasma_glucose diastolic_bp skinfold insulin
#&gt;  * &lt;int&gt;         &lt;dbl&gt;       &lt;int&gt;          &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
#&gt;  1    50          40.1           6           148.         72.0     35.0   169. 
#&gt;  2    31          26.1           1            85.         66.0     29.0   169. 
#&gt;  3    32          44.8           8           183.         64.0     29.0   169. 
#&gt;  4    21          26.6           1            89.         66.0     23.0    94.0
#&gt;  5    33          34.0           0           137.         40.0     35.0   168. 
#&gt;  6    30          33.0           5           116.         74.0     29.0   169. 
#&gt;  7    29          39.6          10           115.         72.4     29.0   169. 
#&gt;  8    53          40.0           2           197.         70.0     45.0   543. 
#&gt;  9    54          38.2           8           125.         96.0     29.0   169. 
#&gt; 10    30          34.2           4           110.         92.0     29.0   169. 
#&gt; # ... with 81 more rows, and 9 more variables: pedigree &lt;dbl&gt;,
#&gt; #   weight_class_normal &lt;dbl&gt;, weight_class_obese &lt;dbl&gt;,
#&gt; #   weight_class_overweight &lt;dbl&gt;, weight_class_missing &lt;dbl&gt;,
#&gt; #   weight_class_other &lt;dbl&gt;, diabetes_Y &lt;dbl&gt;, diabetes_other &lt;dbl&gt;,
#&gt; #   diabetes_missing &lt;dbl&gt;</div><div class='input'>
<span class='co'>### Faster model training without tuning hyperparameters ###</span>

<span class='co'># Train models at set hyperparameter values by setting tune to FALSE. This is</span>
<span class='co'># faster (especially on larger datasets), but produces models with less</span>
<span class='co'># predictive accuracy.</span>
<span class='fu'>machine_learn</span>(<span class='no'>d</span>$<span class='no'>train</span>, <span class='no'>patient_id</span>, <span class='kw'>outcome</span> <span class='kw'>=</span> <span class='no'>diabetes</span>, <span class='kw'>tune</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='message'>Training new data prep recipe</span></div><div class='output co'>#&gt; <span class='message'>Variable(s) ignored in prep_data won't be used to tune models: patient_id</span></div><div class='output co'>#&gt; <span class='message'>diabetes looks categorical, so training classification algorithms.</span></div><div class='output co'>#&gt; <span class='message'>Training at fixed values: Random Forest</span></div><div class='output co'>#&gt; <span class='message'>Training at fixed values: k-Nearest Neighbors</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>*** Models successfully trained. The model object contains the training data minus ignored ID columns. ***</span>
#&gt; <span class='message'>*** If there was PHI in training data, normal PHI protocols apply to the model object. ***</span></div><div class='output co'>#&gt; Algorithms Trained: Random Forest, k-Nearest Neighbors
#&gt; Target: diabetes
#&gt; Class: Classification
#&gt; Performance Metric: AUROC
#&gt; Number of Observations: 91
#&gt; Number of Features: 12
#&gt; Models Trained: 2018-04-20 13:20:19 
#&gt; 
#&gt; Models have not been tuned. Performance estimated via 5-fold cross validation at fixed hyperparameter values.
#&gt; Best model: Random Forest
#&gt; AUPR = 0.57, AUROC = 0.78
#&gt; User-selected hyperparameter values:
#&gt;   mtry = 3
#&gt;   splitrule = extratrees
#&gt;   min.node.size = 1 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Levi Thatcher, Michael Levy, Mike Mastanduno, Taylor Larsen, Taylor Miller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

